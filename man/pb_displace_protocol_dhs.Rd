% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/displace_admin.R
\name{pb_displace_protocol_dhs}
\alias{pb_displace_protocol_dhs}
\title{DHS-protocol displacement constrained to original administrative unit}
\usage{
pb_displace_protocol_dhs(
  point_sf,
  poly_sf,
  point_id = "DHSID",
  poly_id = "ID_2",
  useCRS = NULL,
  urban_col = "URBAN_RURA",
  p_rural_hi = 0.01,
  rural_max = 5000,
  rural_max_hi = 10000,
  urban_max = 2000,
  uniform_area = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{point_sf}{An `sf` object with POINT geometry representing original locations.}

\item{poly_sf}{An `sf` object with POLYGON/MULTIPOLYGON geometry used to constrain
displacement (e.g., admin2 boundaries).}

\item{point_id}{Name of the unique ID column in `point_sf` (default `"DHSID"`).}

\item{poly_id}{Name of the unique ID column in `poly_sf` (default `"ID_2"`).}

\item{verbose}{Logical; if TRUE, prints iteration progress messages (default TRUE).}
}
\value{
An `sf` object with displaced POINT geometry and original attributes, plus:
  - the original admin ID column (`poly_id`)
  - the displaced admin ID column (`paste0(poly_id, ".disp")`)
  - displacement diagnostic columns created by `pb_displace_once_dhs()` (e.g.,
    `originalX`, `originalY`, offsets, etc.)
}
\description{
Applies DHS-style displacement (urban up to 2 km; rural up to 5 km with a small
fraction allowed up to 10 km) and **repeats the displacement draw** until every
displaced point falls within the same administrative polygon as its original
location.
}
\details{
Internally, this function:
1. assigns each original point to an admin polygon via `pb_assign_admin()`;
2. displaces points once via `pb_displace_once_dhs()`;
3. re-assigns displaced points to polygons;
4. re-draws displacement only for points whose polygon changed (or became NA),
   repeating until all points match.
}
\examples{
\dontrun{
displaced <- pb_displace_protocol_dhs(
  point_sf = dhs_sf,
  poly_sf = adm2_sf,
  point_id = "DHSID",
  poly_id = "ID_2"
)
}
}
