% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/join_polygon.R
\name{pb_polyProbsJoin}
\alias{pb_polyProbsJoin}
\title{Polygon membership probabilities under positional uncertainty}
\usage{
pb_polyProbsJoin(
  displaced.sf,
  polygons.sf,
  displaced.id = "DHSID",
  polygons.id = "SPAID",
  densityBuffer = NULL,
  adminBound = NULL,
  adminID = NULL,
  drop_zero = TRUE
)
}
\arguments{
\item{displaced.sf}{`sf` POINT object of displaced locations (one per ID).}

\item{polygons.sf}{`sf` POLYGON/MULTIPOLYGON object to join against.}

\item{displaced.id}{Unique ID column in `displaced.sf`.}

\item{polygons.id}{Unique ID column in `polygons.sf`.}

\item{densityBuffer}{Optional pb_densityBuffer object (from `pb_densityBuffer()`).}

\item{adminBound}{Optional admin polygons used to trim kernels (passed to
`pb_apply_densityBuffer()`).}

\item{adminID}{Polygon ID column in `adminBound` (required if `adminBound` provided).}

\item{drop_zero}{If TRUE, drop polygons with probability 0 (default TRUE).}
}
\value{
A data.frame with columns:
  - displaced.id
  - polygons.id
  - p_hat (probability mass; sums to ~1 per displaced.id if candidates cover space)
}
\description{
Returns a discrete distribution of polygon membership probabilities for each
displaced point. Probability mass is computed by applying a `densityBuffer`
at each displaced point, assigning each candidate location to a polygon, and
summing candidate weights by polygon ID.

If `densityBuffer` is NULL, this performs a conventional point-in-polygon join
and returns probability 1 for the polygon containing the point (or no rows if
none).
}
