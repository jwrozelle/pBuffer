% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/displace_dhs.R
\name{pb_displace_once_dhs}
\alias{pb_displace_once_dhs}
\title{DHS-style single-draw coordinate displacement}
\usage{
pb_displace_once_dhs(
  sfDataset,
  useCRS = NULL,
  urban_col = "URBAN_RURA",
  p_rural_hi = 0.01,
  rural_max = 5000,
  rural_max_hi = 10000,
  urban_max = 2000,
  uniform_area = FALSE
)
}
\arguments{
\item{sfDataset}{An `sf` object with POINT geometry. Must contain a column
indicating urban/rural status.}

\item{useCRS}{Optional CRS override. May be an EPSG integer, a `crs` object,
or `NULL`. If `NULL` (default), the output CRS is taken from `sfDataset`.}

\item{urban_col}{Name of the urban/rural indicator column (default `"URBAN_RURA"`).
Values are expected to be `"U"` and `"R"`.}

\item{p_rural_hi}{Proportion of rural points assigned the larger maximum
displacement (default `0.01`).}

\item{rural_max}{Maximum displacement in meters for most rural points (default `5000`).}

\item{rural_max_hi}{Maximum displacement in meters for the `p_rural_hi` rural points
(default `10000`).}

\item{urban_max}{Maximum displacement in meters for urban points (default `2000`).}

\item{uniform_area}{Logical. If `FALSE` (default), distances are drawn uniform in
radius: `r ~ U(0, max)`. If `TRUE`, distances are drawn uniform over area within
the circle: `r ~ sqrt(U(0,1)) * max`. DHS documentation is commonly interpreted as
random displacement within a circle; analysts differ on whether that implies
uniform radius vs uniform areaâ€”choose explicitly.}
}
\value{
An `sf` object with displaced POINT geometry. The output includes:
  `originalX`, `originalY`, `angle_rad`, `m_displaced`, `random_meters`,
  `xOffset`, `yOffset` as columns, plus all original non-geometry attributes.
}
\description{
Displaces point coordinates according to DHS-style public release rules:
urban clusters are displaced uniformly up to 2 km; rural clusters are displaced
uniformly up to 5 km, with a small fraction (default 1%) displaced up to 10 km.
}
\details{
This function performs **one** displacement draw per input point. If you want
a probability buffer (many candidate locations with weights), wrap this in a
Monte Carlo routine (e.g., replicate draws per point and aggregate).

Important: This function assumes the input geometry is in a **projected CRS
with meter units**. If you pass lon/lat coordinates, the displacement will be
wrong because offsets are computed in meters.
}
\examples{
\dontrun{
# dhs_sf is an sf POINT layer in a projected CRS (meters) with URBAN_RURA column
displaced <- pb_displace_once_dhs(dhs_sf)
}
}
